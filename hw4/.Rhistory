library(tidyverse)
library(magrittr)
pku=read_table("HW4_PKU.txt",col_names=c("pair","case","sibling"),skip=1)
Hyper=c(1100,1320,1350,1450,1600,1850,1900,1990,2050,2120,2200,2210,2500,2610,2720)
Normal=c(1000,1220,1300,1400,1555,1600,1780,1780,1900,2020,2350,2375)
knitr::opts_chunk$set(echo = TRUE)
dat <- data.frame(group=c(rep("Hyper",each=))
length(Hyper)
length(N)
length(Normal)
dat <- data.frame(group=c(rep("Hyper",each=15),rep("Normal",each=12)),avg.na=c(Hyper,Normal))
dat
Hyper
group_by(dat,group)%>%summarise(count=n(),median=median(avg.na,na.rm=T),IQR=IQR(avg.na,na.rm=T))
dat.sum=group_by(dat,group)%>%summarise(count=n(),median=median(avg.na,na.rm=T),IQR=IQR(avg.na,na.rm=T))
dat.sum
dat
dat%>% arrange(avg.na)
dat.rank=dat%>% arrange(avg.na)
dat.rank
dat <- data.frame(group=c(rep("Hyper",each=15),rep("Normal",each=12)),avg.na=c(Hyper,Normal))
dat
dat.rank=dat%>% arrange(avg.na)
dat.rank
choose(27,15)
choose(27,12)
choose(7,3)
dat2=dat.rank%>%mutate(rank=min.rank(avg.na))
dat2=dat.rank%>%mutate(rank=min_rank(avg.na))
dat2
library(tidyverse)
library(magrittr)
pku=read_table("HW4_PKU.txt",col_names=c("pair","case","sibling"),skip=1)
knitr::opts_chunk$set(echo = TRUE)
Hyper=c(1100,1320,1350,1450,1600,1850,1900,1990,2050,2120,2200,2210,2500,2610,2720)
Normal=c(1000,1220,1300,1400,1555,1600,1780,1780,1900,2020,2350,2375)
dat <- data.frame(group=c(rep("Hyper",each=15),rep("Normal",each=12)),avg.na=c(Hyper,Normal))
dat.rank=dat%>% arrange(avg.na)%>%mutate(rank=min_rank(avg.na))
dat.rank
dat.rank=dat%>% arrange(avg.na)%>%mutate(rank=(rank(avg.na,ties.method = "average"))
)
dat.rank
dat.rank%>%filter(group="Hyper")%>%sum(rank)
dat.rank%>%filter(group=="Hyper")%>%sum(rank)
dat.rank%>%filter(group=="Hyper")
dat.rank%>%filter(group=="Hyper")%>%summarise(ranksum=sum(rank))
hyper.ranksum=dat.rank%>%filter(group=="Hyper")%>%summarise(ranksum=sum(rank))
norml.ranksum=dat.rank%>%filter(group=="Normal")%>%summarise(ranksum=sum(rank))
hyper.ranksum
normal.ranksum=dat.rank%>%filter(group=="Normal")%>%summarise(ranksum=sum(rank))
normal.ranksum
wilcox.test(Hyper,Normal,alternative = "notequal",exact=F,correct=F)
wilcox.test(Hyper,Normal,alternative = "two.sided",exact=F,correct=F)
238/choose(27,15)
pbinom(0:27,27,.5)
sum(1:27)
27-12
sum(16:27)
sum(16:27)
sum(1:12)
dat.rank
normal.ranksum
12*14
140+238
15*28-15/(27*26)
dat.rank$rank
length(dat.rank$rank)-length(unique(dat.rank$rank))
9.5*10.5*11.5+11.5*12.5*13.5+14.5*15.5*16.5
6796.125*2
15*28-((15*13592.25)/(27*26))
15*28
hyper.ranksum=dat.rank%>%filter(group=="Hyper")%>%summarise(ranksum=sum(rank))
normal.ranksum=dat.rank%>%filter(group=="Normal")%>%summarise(ranksum=sum(rank))
varw=(12*15*28)/12-(12*15*6)/(12*27*26)
Ew=(12*27*28)/(27*2)
hyper.ranksum=dat.rank%>%filter(group=="Hyper")%>%summarise(ranksum=sum(rank))
normal.ranksum=dat.rank%>%filter(group=="Normal")%>%summarise(ranksum=sum(rank))
varw=(12*15*28)/12-(12*15*6)/(12*27*26)
Ew=(12*27*28)/(27*2)
varw
Ew
hyper.ranksum=dat.rank%>%filter(group=="Hyper")%>%summarise(ranksum=sum(rank))
normal.ranksum=dat.rank%>%filter(group=="Normal")%>%summarise(ranksum=sum(rank))
varw=(12*15*28)/12-(12*15*18)/(12*27*26)
Ew=(12*27*28)/(27*2)
varw
Ew
15*14
12*28
336/2
hyper.ranksum=dat.rank%>%filter(group=="Hyper")%>%summarise(ranksum=sum(rank))
normal.ranksum=dat.rank%>%filter(group=="Normal")%>%summarise(ranksum=sum(rank))
varw=(12*15*28)/12-(12*15*18)/(12*27*26)
Ew=12*28/2
Ew
normal.ranksum
